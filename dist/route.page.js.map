{"version":3,"sources":["../src/route.page.js"],"names":["auth","router","Router","get","req","res","next","render","title","session","user","clearCookie","cookieName","path","redirect","adminRequired","id","query","findOne","_id","err","post","mkContent","content","module","exports"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;IAAYA,I;;;;;;AAEZ,IAAMC,SAAS,kBAAQC,MAAR,EAAf;;AAGA;AACAD,OAAOE,GAAP,CAAW,GAAX,EAAgB,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACvC;AACA;AACA;AACA;AACAD,MAAIE,MAAJ,CAAW,OAAX,EAAoB,EAAEC,OAAO,OAAT,EAApB;AACD,CAND;;AAQA;AACAP,OAAOE,GAAP,CAAW,SAAX,EAAsB,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AAC7CD,MAAIE,MAAJ,CAAW,QAAX;AACD,CAFD;;AAIA;AACAN,OAAOE,GAAP,CAAW,SAAX,EAAsB,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC9CD,MAAIE,MAAJ,CAAW,QAAX;AACD,CAFD;;AAIA;AACAN,OAAOE,GAAP,CAAW,UAAX,EAAuB,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC/CF,MAAIK,OAAJ,CAAYC,IAAZ,GAAmB,IAAnB;AACAL,MAAIM,WAAJ,CAAgB,iBAAOC,UAAvB,EAAmC,EAAEC,MAAM,GAAR,EAAnC;AACAR,MAAIS,QAAJ,CAAa,GAAb;AACD,CAJD;;AAMA;AACAb,OAAOE,GAAP,CAAW,QAAX,EAAqB,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AAC5CD,MAAIE,MAAJ,CAAW,OAAX,EAAoB,EAAEC,OAAO,OAAT,EAApB;AACD,CAFD;;AAKA;AACAP,OAAOE,GAAP,CAAW,eAAX,EAA4BH,KAAKe,aAAjC,EAAgD,UAASX,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACvED,MAAIE,MAAJ,CAAW,QAAX;AACD,CAFD;;AAIA;AACAN,OAAOE,GAAP,CAAW,aAAX,EAA0B,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAAA,MAC1CU,EAD0C,GACnCZ,IAAIa,KAD+B,CAC1CD,EAD0C;;;AAGlD,iBAAUE,OAAV,CAAkB,EAAEC,KAAKH,EAAP,EAAlB,EAA+B,UAAUI,GAAV,EAAeC,IAAf,EAAqB;AAClDA,SAAKC,SAAL,GAAiB,sBAAOD,KAAKE,OAAZ,CAAjB;AACAlB,QAAIE,MAAJ,CAAW,MAAX,EAAmB,EAACc,UAAD,EAAnB;AACD,GAHD;AAID,CAPD;;AASA;AACApB,OAAOE,GAAP,CAAW,aAAX,EAA0B,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAAA,MAC1CU,EAD0C,GACnCZ,IAAIa,KAD+B,CAC1CD,EAD0C;;AAElDX,MAAIE,MAAJ,CAAW,MAAX,EAAmB,EAAES,MAAF,EAAnB;AACD,CAHD;;AAKAQ,OAAOC,OAAP,GAAiBxB,MAAjB","file":"route.page.js","sourcesContent":["import express from 'express';\nimport PostModel from './models/post';\nimport marked from 'marked';\nimport bcrypt from 'bcrypt';\nimport config from './config';\nimport * as auth from './middlewares/auth';\n\nconst router = express.Router();\n\n\n/* GET home page. */\nrouter.get('/', function(req, res, next) {\n  // locals的用法，可以传 path函数及函数方法给对象view中的title使用，\n  // 并且可以统一传给多个view,render只能当前view传递title 值\n  // res.locals.title = 'subin';\n  // res.render('index');\n  res.render('index', { title: 'subin' });\n});\n\n/* GET signup page. */\nrouter.get('/signup', function(req, res, next) {\n  res.render('signup');\n});\n\n/* GET signin page. */\nrouter.get('/signin', function (req, res, next) {\n  res.render('signin');\n});\n\n/* GET signout */\nrouter.get('/signout', function (req, res, next) {\n  req.session.user = null;\n  res.clearCookie(config.cookieName, { path: '/' });\n  res.redirect('/');\n});\n\n/* GET posts page. */\nrouter.get('/posts', function(req, res, next) {\n  res.render('posts', { title: 'posts'} );\n});\n\n\n// /posts/create\nrouter.get('/posts/create', auth.adminRequired, function(req, res, next) {\n  res.render('create');\n});\n\n/* GET posts show page. */\nrouter.get('/posts/show', function (req, res, next) {\n  const { id } = req.query;\n\n  PostModel.findOne({ _id: id }, function (err, post) {\n    post.mkContent = marked(post.content);\n    res.render('show', {post});\n  });\n});\n\n/* GET posts edit page. */\nrouter.get('/posts/edit', function (req, res, next) {\n  const { id } = req.query;\n  res.render('edit', { id });\n});\n\nmodule.exports = router;\n"]}